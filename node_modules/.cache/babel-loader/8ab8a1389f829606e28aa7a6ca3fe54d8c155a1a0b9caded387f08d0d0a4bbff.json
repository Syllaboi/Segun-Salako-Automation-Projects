{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import axios from'axios';import ChatMessage from'./ChatMessage';import TypingIndicator from'./TypingIndicator';import VoiceRecorder from'./VoiceRecorder';import{Bot,Zap}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ChatInterface=()=>{const[messages,setMessages]=useState([]);const[isProcessing,setIsProcessing]=useState(false);const messagesEndRef=useRef(null);const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};useEffect(()=>{scrollToBottom();},[messages,isProcessing]);useEffect(()=>{// Add welcome message from Smith\nsetMessages([{id:1,text:\"Hello! I'm Smith, your AI assistant. Feel free to speak to me using the microphone button below.\",isSmith:true,timestamp:new Date().toISOString()}]);},[]);const handleTranscription=async transcription=>{if(!transcription.trim())return;// Add user message\nconst userMessage={id:Date.now(),text:transcription,isSmith:false,timestamp:new Date().toISOString()};setMessages(prev=>[...prev,userMessage]);setIsProcessing(true);try{// Send to webhook - replace with your actual webhook URL\nconst webhookUrl=process.env.REACT_APP_WEBHOOK_URL||'https://your-webhook-url.com/api/chat';const response=await axios.post(webhookUrl,{message:transcription,userId:'user-'+Date.now(),timestamp:new Date().toISOString()},{headers:{'Content-Type':'application/json'},timeout:30000// 30 second timeout\n});// Add Smith's response\nconst smithMessage={id:Date.now()+1,text:response.data.message||response.data.response||\"I received your message, but I'm having trouble responding right now.\",isSmith:true,timestamp:new Date().toISOString()};setMessages(prev=>[...prev,smithMessage]);// Optional: Use ElevenLabs to speak the response\nif(response.data.message||response.data.response){await speakText(smithMessage.text);}}catch(error){console.error('Error sending message to webhook:',error);// Add error message from Smith\nconst errorMessage={id:Date.now()+1,text:\"I'm sorry, I'm having trouble connecting right now. Please try again in a moment.\",isSmith:true,timestamp:new Date().toISOString()};setMessages(prev=>[...prev,errorMessage]);}finally{setIsProcessing(false);}};const speakText=async text=>{try{// Replace with your ElevenLabs API key and voice ID\nconst elevenLabsApiKey=process.env.REACT_APP_ELEVENLABS_API_KEY;const voiceId=process.env.REACT_APP_ELEVENLABS_VOICE_ID||'default-voice-id';if(!elevenLabsApiKey){console.log('ElevenLabs API key not configured');return;}const response=await axios.post(\"https://api.elevenlabs.io/v1/text-to-speech/\".concat(voiceId),{text:text,model_id:\"eleven_monolingual_v1\",voice_settings:{stability:0.5,similarity_boost:0.5}},{headers:{'Accept':'audio/mpeg','Content-Type':'application/json','xi-api-key':elevenLabsApiKey},responseType:'blob'});// Play the audio\nconst audioUrl=URL.createObjectURL(response.data);const audio=new Audio(audioUrl);await audio.play();// Clean up\naudio.onended=()=>URL.revokeObjectURL(audioUrl);}catch(error){console.error('Error with text-to-speech:',error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col h-screen bg-dark-primary\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"glass-effect p-4 border-b border-dark-border\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center space-x-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Bot,{className:\"w-8 h-8 text-blue-neon\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute -top-1 -right-1 w-3 h-3 bg-green-neon rounded-full animate-pulse\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-bold text-dark-text\",children:\"Smith\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-dark-muted\",children:\"AI Assistant\"})]}),/*#__PURE__*/_jsx(Zap,{className:\"w-6 h-6 text-blue-neon animate-pulse\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 overflow-y-auto p-4 space-y-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto\",children:[messages.map(message=>/*#__PURE__*/_jsx(ChatMessage,{message:message.text,isSmith:message.isSmith,timestamp:message.timestamp},message.id)),isProcessing&&/*#__PURE__*/_jsx(TypingIndicator,{}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"glass-effect border-t border-dark-border\",children:[/*#__PURE__*/_jsx(VoiceRecorder,{onTranscription:handleTranscription,isProcessing:isProcessing}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center pb-4\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-dark-muted\",children:\"Tap the microphone to speak with Smith\"})})]})]});};export default ChatInterface;","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","ChatMessage","TypingIndicator","VoiceRecorder","Bot","Zap","jsx","_jsx","jsxs","_jsxs","ChatInterface","messages","setMessages","isProcessing","setIsProcessing","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","id","text","isSmith","timestamp","Date","toISOString","handleTranscription","transcription","trim","userMessage","now","prev","webhookUrl","process","env","REACT_APP_WEBHOOK_URL","response","post","message","userId","headers","timeout","smithMessage","data","speakText","error","console","errorMessage","elevenLabsApiKey","REACT_APP_ELEVENLABS_API_KEY","voiceId","REACT_APP_ELEVENLABS_VOICE_ID","log","concat","model_id","voice_settings","stability","similarity_boost","responseType","audioUrl","URL","createObjectURL","audio","Audio","play","onended","revokeObjectURL","className","children","map","ref","onTranscription"],"sources":["/workspace/src/components/ChatInterface.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport ChatMessage from './ChatMessage';\nimport TypingIndicator from './TypingIndicator';\nimport VoiceRecorder from './VoiceRecorder';\nimport { Bot, Zap } from 'lucide-react';\n\nconst ChatInterface = () => {\n  const [messages, setMessages] = useState([]);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const messagesEndRef = useRef(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages, isProcessing]);\n\n  useEffect(() => {\n    // Add welcome message from Smith\n    setMessages([{\n      id: 1,\n      text: \"Hello! I'm Smith, your AI assistant. Feel free to speak to me using the microphone button below.\",\n      isSmith: true,\n      timestamp: new Date().toISOString()\n    }]);\n  }, []);\n\n  const handleTranscription = async (transcription) => {\n    if (!transcription.trim()) return;\n\n    // Add user message\n    const userMessage = {\n      id: Date.now(),\n      text: transcription,\n      isSmith: false,\n      timestamp: new Date().toISOString()\n    };\n\n    setMessages(prev => [...prev, userMessage]);\n    setIsProcessing(true);\n\n    try {\n      // Send to webhook - replace with your actual webhook URL\n      const webhookUrl = process.env.REACT_APP_WEBHOOK_URL || 'https://your-webhook-url.com/api/chat';\n      \n      const response = await axios.post(webhookUrl, {\n        message: transcription,\n        userId: 'user-' + Date.now(),\n        timestamp: new Date().toISOString()\n      }, {\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        timeout: 30000 // 30 second timeout\n      });\n\n      // Add Smith's response\n      const smithMessage = {\n        id: Date.now() + 1,\n        text: response.data.message || response.data.response || \"I received your message, but I'm having trouble responding right now.\",\n        isSmith: true,\n        timestamp: new Date().toISOString()\n      };\n\n      setMessages(prev => [...prev, smithMessage]);\n\n      // Optional: Use ElevenLabs to speak the response\n      if (response.data.message || response.data.response) {\n        await speakText(smithMessage.text);\n      }\n\n    } catch (error) {\n      console.error('Error sending message to webhook:', error);\n      \n      // Add error message from Smith\n      const errorMessage = {\n        id: Date.now() + 1,\n        text: \"I'm sorry, I'm having trouble connecting right now. Please try again in a moment.\",\n        isSmith: true,\n        timestamp: new Date().toISOString()\n      };\n\n      setMessages(prev => [...prev, errorMessage]);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const speakText = async (text) => {\n    try {\n      // Replace with your ElevenLabs API key and voice ID\n      const elevenLabsApiKey = process.env.REACT_APP_ELEVENLABS_API_KEY;\n      const voiceId = process.env.REACT_APP_ELEVENLABS_VOICE_ID || 'default-voice-id';\n\n      if (!elevenLabsApiKey) {\n        console.log('ElevenLabs API key not configured');\n        return;\n      }\n\n      const response = await axios.post(\n        `https://api.elevenlabs.io/v1/text-to-speech/${voiceId}`,\n        {\n          text: text,\n          model_id: \"eleven_monolingual_v1\",\n          voice_settings: {\n            stability: 0.5,\n            similarity_boost: 0.5\n          }\n        },\n        {\n          headers: {\n            'Accept': 'audio/mpeg',\n            'Content-Type': 'application/json',\n            'xi-api-key': elevenLabsApiKey\n          },\n          responseType: 'blob'\n        }\n      );\n\n      // Play the audio\n      const audioUrl = URL.createObjectURL(response.data);\n      const audio = new Audio(audioUrl);\n      await audio.play();\n      \n      // Clean up\n      audio.onended = () => URL.revokeObjectURL(audioUrl);\n    } catch (error) {\n      console.error('Error with text-to-speech:', error);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col h-screen bg-dark-primary\">\n      {/* Header */}\n      <div className=\"glass-effect p-4 border-b border-dark-border\">\n        <div className=\"flex items-center justify-center space-x-3\">\n          <div className=\"relative\">\n            <Bot className=\"w-8 h-8 text-blue-neon\" />\n            <div className=\"absolute -top-1 -right-1 w-3 h-3 bg-green-neon rounded-full animate-pulse\"></div>\n          </div>\n          <div>\n            <h1 className=\"text-xl font-bold text-dark-text\">Smith</h1>\n            <p className=\"text-sm text-dark-muted\">AI Assistant</p>\n          </div>\n          <Zap className=\"w-6 h-6 text-blue-neon animate-pulse\" />\n        </div>\n      </div>\n\n      {/* Messages */}\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n        <div className=\"max-w-4xl mx-auto\">\n          {messages.map((message) => (\n            <ChatMessage\n              key={message.id}\n              message={message.text}\n              isSmith={message.isSmith}\n              timestamp={message.timestamp}\n            />\n          ))}\n          \n          {isProcessing && <TypingIndicator />}\n          \n          <div ref={messagesEndRef} />\n        </div>\n      </div>\n\n      {/* Voice Input */}\n      <div className=\"glass-effect border-t border-dark-border\">\n        <VoiceRecorder \n          onTranscription={handleTranscription}\n          isProcessing={isProcessing}\n        />\n        \n        <div className=\"text-center pb-4\">\n          <p className=\"text-xs text-dark-muted\">\n            Tap the microphone to speak with Smith\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ChatInterface;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}